# Predictive-Modeling-with-Market-Dynamics
Designed a framework that predicts LL100 index movements and implemented trading strategies(Momentum, Pairs-trading).

# **Predictive Modeling with Market Dynamics**

## **Objective**
This project aims to design a framework that predicts LL100 index movements by analyzing market dynamics, identifying causal relationships, and implementing machine learning and econometric models.

---

## **Repository Structure**

- backtest.py              # Backtesting script for evaluating strategies
- eval.py                  # Evaluation metrics and model performance analysis
- project1.ipynb.zip       # Jupyter notebook with the main analysis (zipped)
- rolling_window_finetune.py  # Rolling window approach and parameter tuning
- data/                        # Data files used for analysis and modeling
- temp_result/                 # Outputs and reports
- Project1_Report.pdf      # Detailed project report



---

## **Key Steps**

### **1. Non-Stationarity Analysis**
- Validate and test assumptions about stationarity in financial time series using the Augmented Dickey-Fuller (ADF) test.
- Handle non-stationary relationships using:
  - Differencing
  - Log transformation followed by differencing
  - Seasonal decomposition to separate trend, seasonality, and residuals.

### **2. Causal Relationship Mapping**
- Identify lead-lag relationships between indices using:
  - Correlation analysis (e.g., high correlations between INDU and FINA, SP500 and INFT).
  - Granger causality tests to determine predictive relationships between variables.
- Validate causal relationships with financial theory (e.g., financial sector leading industrial sector due to capital flow dynamics).

---

## **Modeling**

### **Econometric Models**
1. **OLS Regression**
   - Residuals were stationary but exhibited autocorrelation, making OLS coefficients consistent but inefficient.
   - Performance on the test set was poor, prompting exploration of regularization techniques.

2. **Regularized Regression**
   - **Elastic Net**: Achieved the best performance among linear models with:
     - R² ≈ 0.77
     - Explained Variance Score ≈ 0.80
   - Combines L1 (Lasso) and L2 (Ridge) penalties to handle multicollinearity and feature selection.

### **Machine Learning Models**
1. **Tree-Based Models**
   - **Random Forest, LightGBM, XGBoost**:
     - LightGBM outperformed other ML models after parameter tuning with a rolling window approach.
     - However, Elastic Net still provided better predictive performance.

2. **LSTM (Long Short-Term Memory)**
   - Struggled due to the small dataset and strong trends.
   - Marginal improvements were achieved after fine-tuning and removing trends via decomposition.

### **Evaluation Metrics**
- **Mean Squared Error (MSE)**: Measures average squared differences between predictions and actuals.
- **Mean Absolute Error (MAE)**: Evaluates average absolute differences, robust to outliers.
- **R² and Explained Variance**: Assess the proportion of variance explained by the model.
- **Directional Accuracy**: Evaluates how often the model predicts the correct direction of change in LL100.

---

## **Strategy**

### **Momentum Strategy Design**
The trading strategy is based on signals generated by the Elastic Net model, which demonstrated the best predictive performance. Key components of the strategy include:

1. **Entry and Exit Rules**
   - Use the predicted direction of LL100 as the primary signal for entering or exiting positions.
   - For example:
     - **Buy Signal**: When the model predicts an upward movement in LL100.
     - **Sell Signal**: When the model predicts a downward movement in LL100.

2. **Risk Management**
   - Implement stop-loss and take-profit levels to manage downside risk and lock in profits.
   - Use position sizing techniques to limit exposure to any single trade.

3. **Backtesting**
   - Evaluate the strategy using historical data to assess profitability and robustness.
   - Analyze performance metrics like Sharpe ratio, drawdowns, and win/loss ratios.

### **Implementation Details**
- **Expanding Window Prediction**:
  - Train the model on data from 2016 to predict LL100 for 2017, expanding the training set daily.
  - Avoid using future data by shifting predictions by one day.
- **Handling Missing Data**:
  - Use forward fill to address missing values in features.
  - For weekends, simulate LL100 values by adding random noise to Friday’s data.

---

## **Usage Instructions**

Ensure you have the following installed:
- Python 3.8 or higher
- Required libraries: `pandas`, `numpy`, `scikit-learn`, `statsmodels`, `matplotlib`, `seaborn`, `lightgbm`, `xgboost`

Install dependencies using:
```bash
pip install -r requirements.txt




